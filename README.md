# Monytor

Monytor is a configurable monitoring tool written in .NET Core. 

## Overview
Monytor runs "Collectors" which are responsible for collecting data. The result will be saved in a database (RavenDB) as a time series. A bunch of collectors is already available but can easily extended. All collectors can be scheduled independently with many arguments and can be extended with "verifiers" and "notifications".

## Presentation
A dashboard visualizes all collected data. Therefore, Monytor provides a Web API to access all time series.

![Monytor Dashboard](/images/monytor_dashboard.png?raw=true)

## Build

Build Monytor
```
dotnet build ./monytor
```

Build Monytor.WebApi
```
dotnet build ./monytor.webapi
```

## Setup

Before you can run Monytor you have to update the "*collectorconfig.json*" which should be already available. A default configuration can be generated by calling

```
cd monytor
dotnet run --CreateDefaultConfig
```
Typically a config looks like that:

```json
{
  "Notifications": [
    {
      "$type": "Monytor.Implementation.Notifications.EmailNotification, Monytor.Implementation",
      "Id": "Monytor.EmailNotification",
      "Smtp": "smtp.example.com",
      "Port": "587",
      "UseDefaultCredentials": false,
      "User": "YOUR_USERNAME",
      "Password": "YOUR_PASSWORD",
      "To": [
        "admin@example.com"
      ],
      "From": "alert@example.com",
      "SubjectPrefix": "ALERT: "
    }
  ],
  "Collectors": [
    {
      "$type": "Monytor.Implementation.Collectors.AllCollectionCollector, Monytor.Implementation",
      "Source": {
        "Url": "http://localhost:8080",
        "Database": "Monytor"
      },
      "GroupName": "Collection",
      "StartingTimeDelay": "00:00:00",
      "RandomTimeDelay": "00:00:00",
      "PollingInterval": "01:00:00",
      "OverlappingReccuring": false,
      "StartingTime": null,
      "EndAt": null,
      "Priority": 3,
      "Verifiers": [
        {
          "$type": "Monytor.Implementation.Verifiers.SerieChangeVerifier, Monytor.Implementation",
          "Group": "Collection",
          "Tag": "Serie",
          "TimeInterval": "01:00:00",
          "SerieRepository": null,
          "Notifications": [
            "Monytor.EmailNotification"
          ]
        }
      ]
    }
  ]
}
```

### Collectors
Currently the following collectors are available:
* AllCollectionCollector
  * Counts all documents in every collection for a RavenDB
* CollectionCollector
  * Counts all documents in a collection for a RavenDB
* StartingWithCollector
  * Counts all documents in a RavenDB starting with a document id
* SystemInformationCollector
  * Counts several metrics of the current system
  
## Run
To collect data run Monytor
```
cd monytor
dotnet run
```

Run the server
```
cd monytor.webapi
dotnet run
```

By default the Web API is accessible under `http://localhost:51736/api/serie`. The dashboard can be display under `http://localhost:51736`